{"version":3,"sources":["app/MediateRpcHandlerAddOnBase.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,oEAAkF;AAClF,0DAAgF;AAIhF,MAAM,EAAE,cAAc,EAAE,CAAC,EAAE,GAAG,4BAAS,CAAC;AAExC;;GAEG;AAEH,IAAsB,0BAA0B,GAAhD;IAIC,YACwB,eAAuC,EACvC,WAA+B;QAD/B,oBAAe,GAAf,eAAe,CAAwB;QACvC,gBAAW,GAAX,WAAW,CAAoB;QAEtD,mBAAK,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,eAAe,CAAC,CAAC;QAC3D,mBAAK,CAAC,gBAAgB,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;IACpD,CAAC;IAGD;;OAEG;IACI,IAAI,CAAC,aAAqB,IAAI;QACpC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,UAAU,CAAC;QACrC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC;QACjE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;QACxB,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;IACjC,CAAC;IAED;;OAEG;IACI,UAAU;QAChB,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC1B,CAAC;IAED;;OAEG;IACI,OAAO;QACb,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC;QAC/B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC1B,CAAC;IAGS,cAAc;QACvB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;IACxD,CAAC;CACD,CAAA;AA7CqB,0BAA0B;IAD/C,wBAAU,EAAE;IAMV,WAAA,uBAAS,EAAE,CAAA;IACX,WAAA,uBAAS,EAAE,CAAA;;GANQ,0BAA0B,CA6C/C;AA7CqB,gEAA0B","file":"MediateRpcHandlerAddOnBase.js","sourcesContent":["import { IConfigurationProvider, constants } from '@micro-fleet/common-contracts';\r\nimport { inject, injectable, unmanaged, Guard } from '@micro-fleet/common-util';\r\n\r\nimport { IMediateRpcHandler } from './MediateRpcHandler';\r\n\r\nconst { SvcSettingKeys: S } = constants;\r\n\r\n/**\r\n * Base class for MediateRpcAddOn.\r\n */\r\n@injectable()\r\nexport abstract class MediateRpcHandlerAddOnBase implements IServiceAddOn {\r\n\r\n\tprotected abstract controllerIdentifier: string | symbol;\r\n\r\n\tconstructor(\r\n\t\t@unmanaged() protected _configProvider: IConfigurationProvider,\r\n\t\t@unmanaged() protected _rpcHandler: IMediateRpcHandler\r\n\t) {\r\n\t\tGuard.assertArgDefined('_configProvider', _configProvider);\r\n\t\tGuard.assertArgDefined('_rpcHandler', _rpcHandler);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @see IServiceAddOn.init\r\n\t */\r\n\tpublic init(moduleName: string = null): Promise<void> {\r\n\t\tthis._rpcHandler.module = moduleName;\r\n\t\tthis._rpcHandler.name = this._configProvider.get(S.SERVICE_SLUG);\r\n\t\tthis._rpcHandler.init();\r\n\t\tthis.handleRequests();\r\n\t\treturn this._rpcHandler.start();\r\n\t}\r\n\r\n\t/**\r\n\t * @see IServiceAddOn.deadLetter\r\n\t */\r\n\tpublic deadLetter(): Promise<void> {\r\n\t\treturn Promise.resolve();\r\n\t}\r\n\r\n\t/**\r\n\t * @see IServiceAddOn.dispose\r\n\t */\r\n\tpublic dispose(): Promise<void> {\r\n\t\tthis._configProvider = null;\r\n\t\tlet handler = this._rpcHandler;\r\n\t\tthis._rpcHandler = null;\r\n\t\treturn handler.dispose();\r\n\t}\r\n\r\n\r\n\tprotected handleRequests(): void {\r\n\t\tthis._rpcHandler.handleCRUD(this.controllerIdentifier);\r\n\t}\r\n}"]}